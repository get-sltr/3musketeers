# TheHive 5.x Configuration for SLTR
# Documentation: https://docs.strangebee.com/thehive/

# Play Framework Configuration
play.http.secret.key = "changeme-generate-a-secret-key"

# Database Configuration - Cassandra
db.janusgraph {
  storage {
    backend = cql
    hostname = ["cassandra"]
    cql {
      cluster-name = sltr-thehive
      keyspace = thehive
    }
  }
  index.search {
    backend = elasticsearch
    hostname = ["elasticsearch"]
    index-name = thehive
  }
}

# Storage Configuration
storage {
  provider = localfs
  localfs.location = /opt/thp/thehive/data
}

# Cortex Integration (for automated analysis)
play.modules.enabled += org.thp.thehive.connector.cortex.CortexModule
cortex {
  servers = [
    {
      name = "SLTR-Cortex"
      url = "http://cortex:9001"
      auth {
        type = "bearer"
        # Set this to your Cortex API key after initial setup
        key = "CORTEX_API_KEY_HERE"
      }
    }
  ]
}

# Authentication Configuration
auth {
  providers = [
    {name: session}
    {name: basic, realm: thehive}
    {name: local}
    {name: key}
  ]

  # Initial admin account (change password after first login!)
  defaultUserDomain = "sltr.local"
}

# Application Settings
application.baseUrl = "http://localhost:9000"

# Streaming/SSE Configuration
stream.longPolling.refresh = 1 minute
stream.longPolling.cache = 15 minutes
stream.longPolling.nextItemMaxWait = 500 millis
stream.longPolling.globalMaxWait = 1 second
